{"ast":null,"code":"import bindEvents from '../base/bindEvent.js';\nimport { checkType } from '../base/util.js';\nexport default {\n  name: 'bm-map',\n  props: {\n    ak: {\n      type: String\n    },\n    center: {\n      type: [Object, String]\n    },\n    zoom: {\n      type: Number\n    },\n    minZoom: {\n      type: Number\n    },\n    maxZoom: {\n      type: Number\n    },\n    highResolution: {\n      type: Boolean,\n      default: true\n    },\n    mapClick: {\n      type: Boolean,\n      default: true\n    },\n    mapType: {\n      type: String\n    },\n    dragging: {\n      type: Boolean,\n      default: true\n    },\n    scrollWheelZoom: {\n      type: Boolean,\n      default: false\n    },\n    doubleClickZoom: {\n      type: Boolean,\n      default: true\n    },\n    keyboard: {\n      type: Boolean,\n      default: true\n    },\n    inertialDragging: {\n      type: Boolean,\n      default: true\n    },\n    continuousZoom: {\n      type: Boolean,\n      default: true\n    },\n    pinchToZoom: {\n      type: Boolean,\n      default: true\n    },\n    autoResize: {\n      type: Boolean,\n      default: true\n    },\n    theme: {\n      type: Array\n    },\n    mapStyle: {\n      type: Object\n    }\n  },\n  watch: {\n    center(val, oldVal) {\n      const {\n        map,\n        zoom\n      } = this;\n\n      if (checkType(val) === 'String' && val !== oldVal) {\n        map.centerAndZoom(val, zoom);\n      }\n    },\n\n    'center.lng'(val, oldVal) {\n      const {\n        BMap,\n        map,\n        zoom,\n        center\n      } = this;\n\n      if (val !== oldVal && val >= -180 && val <= 180) {\n        map.centerAndZoom(new BMap.Point(val, center.lat), zoom);\n      }\n    },\n\n    'center.lat'(val, oldVal) {\n      const {\n        BMap,\n        map,\n        zoom,\n        center\n      } = this;\n\n      if (val !== oldVal && val >= -74 && val <= 74) {\n        map.centerAndZoom(new BMap.Point(center.lng, val), zoom);\n      }\n    },\n\n    zoom(val, oldVal) {\n      const {\n        map\n      } = this;\n\n      if (val !== oldVal && val >= 3 && val <= 19) {\n        map.setZoom(val);\n      }\n    },\n\n    minZoom(val) {\n      const {\n        map\n      } = this;\n      map.setMinZoom(val);\n    },\n\n    maxZoom(val) {\n      const {\n        map\n      } = this;\n      map.setMaxZoom(val);\n    },\n\n    highResolution() {\n      this.reset();\n    },\n\n    mapClick() {\n      this.reset();\n    },\n\n    mapType(val) {\n      const {\n        map\n      } = this;\n      map.setMapType(global[val]);\n    },\n\n    dragging(val) {\n      const {\n        map\n      } = this;\n      val ? map.enableDragging() : map.disableDragging();\n    },\n\n    scrollWheelZoom(val) {\n      const {\n        map\n      } = this;\n      val ? map.enableScrollWheelZoom() : map.disableScrollWheelZoom();\n    },\n\n    doubleClickZoom(val) {\n      const {\n        map\n      } = this;\n      val ? map.enableDoubleClickZoom() : map.disableDoubleClickZoom();\n    },\n\n    keyboard(val) {\n      const {\n        map\n      } = this;\n      val ? map.enableKeyboard() : map.disableKeyboard();\n    },\n\n    inertialDragging(val) {\n      const {\n        map\n      } = this;\n      val ? map.enableInertialDragging() : map.disableInertialDragging();\n    },\n\n    continuousZoom(val) {\n      const {\n        map\n      } = this;\n      val ? map.enableContinuousZoom() : map.disableContinuousZoom();\n    },\n\n    pinchToZoom(val) {\n      const {\n        map\n      } = this;\n      val ? map.enablePinchToZoom() : map.disablePinchToZoom();\n    },\n\n    autoResize(val) {\n      const {\n        map\n      } = this;\n      val ? map.enableAutoResize() : map.disableAutoResize();\n    },\n\n    theme(val) {\n      const {\n        map\n      } = this;\n      map.setMapStyle({\n        styleJson: val\n      });\n    },\n\n    'mapStyle.features': {\n      handler(val, oldVal) {\n        const {\n          map,\n          mapStyle\n        } = this;\n        const {\n          style,\n          styleJson\n        } = mapStyle;\n        map.setMapStyle({\n          styleJson,\n          features: val,\n          style\n        });\n      },\n\n      deep: true\n    },\n\n    'mapStyle.style'(val, oldVal) {\n      const {\n        map,\n        mapStyle\n      } = this;\n      const {\n        features,\n        styleJson\n      } = mapStyle;\n      map.setMapStyle({\n        styleJson,\n        features,\n        style: val\n      });\n    },\n\n    'mapStyle.styleJson': {\n      handler(val, oldVal) {\n        const {\n          map,\n          mapStyle\n        } = this;\n        const {\n          features,\n          style\n        } = mapStyle;\n        map.setMapStyle({\n          styleJson: val,\n          features,\n          style\n        });\n      },\n\n      deep: true\n    },\n\n    mapStyle(val) {\n      const {\n        map,\n        theme\n      } = this;\n      !theme && map.setMapStyle(val);\n    }\n\n  },\n  methods: {\n    setMapOptions() {\n      const {\n        map,\n        minZoom,\n        maxZoom,\n        mapType,\n        dragging,\n        scrollWheelZoom,\n        doubleClickZoom,\n        keyboard,\n        inertialDragging,\n        continuousZoom,\n        pinchToZoom,\n        autoResize\n      } = this;\n      minZoom && map.setMinZoom(minZoom);\n      maxZoom && map.setMaxZoom(maxZoom);\n      mapType && map.setMapType(global[mapType]);\n      dragging ? map.enableDragging() : map.disableDragging();\n      scrollWheelZoom ? map.enableScrollWheelZoom() : map.disableScrollWheelZoom();\n      doubleClickZoom ? map.enableDoubleClickZoom() : map.disableDoubleClickZoom();\n      keyboard ? map.enableKeyboard() : map.disableKeyboard();\n      inertialDragging ? map.enableInertialDragging() : map.disableInertialDragging();\n      continuousZoom ? map.enableContinuousZoom() : map.disableContinuousZoom();\n      pinchToZoom ? map.enablePinchToZoom() : map.disablePinchToZoom();\n      autoResize ? map.enableAutoResize() : map.disableAutoResize();\n    },\n\n    init(BMap) {\n      if (this.map) {\n        return;\n      }\n\n      let $el = this.$refs.view;\n\n      for (let $node of this.$slots.default || []) {\n        if ($node.componentOptions && $node.componentOptions.tag === 'bm-view') {\n          this.hasBmView = true;\n          $el = $node.elm;\n        }\n      }\n\n      const map = new BMap.Map($el, {\n        enableHighResolution: this.highResolution,\n        enableMapClick: this.mapClick\n      });\n      this.map = map;\n      const {\n        setMapOptions,\n        zoom,\n        getCenterPoint,\n        theme,\n        mapStyle\n      } = this;\n      theme ? map.setMapStyle({\n        styleJson: theme\n      }) : map.setMapStyle(mapStyle);\n      setMapOptions();\n      bindEvents.call(this, map); // 此处强行初始化一次地图 回避一个由于错误的 center 字符串导致初始化失败抛出的错误\n\n      map.reset();\n      map.centerAndZoom(getCenterPoint(), zoom);\n      this.$emit('ready', {\n        BMap,\n        map\n      }); // Debug\n      // global.map = map\n      // global.mapComponent = this\n    },\n\n    getCenterPoint() {\n      const {\n        center,\n        BMap\n      } = this;\n\n      switch (checkType(center)) {\n        case 'String':\n          return center;\n\n        case 'Object':\n          return new BMap.Point(center.lng, center.lat);\n\n        default:\n          return new BMap.Point();\n      }\n    },\n\n    initMap(BMap) {\n      this.BMap = BMap;\n      this.init(BMap);\n    },\n\n    getMapScript() {\n      if (!global.BMap) {\n        const ak = this.ak || this._BMap().ak;\n\n        global.BMap = {};\n        global.BMap._preloader = new Promise((resolve, reject) => {\n          global._initBaiduMap = function () {\n            resolve(global.BMap);\n            global.document.body.removeChild($script);\n            global.BMap._preloader = null;\n            global._initBaiduMap = null;\n          };\n\n          const $script = document.createElement('script');\n          global.document.body.appendChild($script);\n          $script.src = `https://api.map.baidu.com/api?v=2.0&ak=${ak}&callback=_initBaiduMap`;\n        });\n        return global.BMap._preloader;\n      } else if (!global.BMap._preloader) {\n        return Promise.resolve(global.BMap);\n      } else {\n        return global.BMap._preloader;\n      }\n    },\n\n    reset() {\n      const {\n        getMapScript,\n        initMap\n      } = this;\n      getMapScript().then(initMap);\n    }\n\n  },\n\n  mounted() {\n    this.reset();\n  },\n\n  data() {\n    return {\n      hasBmView: false\n    };\n  }\n\n};","map":{"version":3,"mappings":"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","names":["bindEvents","checkType","name","props","ak","type","String","center","Object","zoom","Number","minZoom","maxZoom","highResolution","Boolean","default","mapClick","mapType","dragging","scrollWheelZoom","doubleClickZoom","keyboard","inertialDragging","continuousZoom","pinchToZoom","autoResize","theme","Array","mapStyle","watch","val","oldVal","map","centerAndZoom","BMap","Point","lat","lng","setZoom","setMinZoom","setMaxZoom","reset","setMapType","global","enableDragging","disableDragging","enableScrollWheelZoom","disableScrollWheelZoom","enableDoubleClickZoom","disableDoubleClickZoom","enableKeyboard","disableKeyboard","enableInertialDragging","disableInertialDragging","enableContinuousZoom","disableContinuousZoom","enablePinchToZoom","disablePinchToZoom","enableAutoResize","disableAutoResize","setMapStyle","styleJson","handler","style","features","deep","methods","setMapOptions","init","$el","$refs","view","$node","$slots","componentOptions","tag","hasBmView","elm","Map","enableHighResolution","enableMapClick","getCenterPoint","call","$emit","initMap","getMapScript","_BMap","_preloader","Promise","resolve","reject","_initBaiduMap","document","body","removeChild","$script","createElement","appendChild","src","then","mounted","data"],"sourceRoot":"","sources":["D:\\MyAllCoding\\SmartCycling\\web\\node_modules\\vue-baidu-map\\components\\map\\Map.vue"],"sourcesContent":["<template>\n<div>\n  <div v-if=\"!hasBmView\" ref=\"view\" style=\"width: 100%; height: 100%\">\n  </div>\n  <slot></slot>\n</div>\n</template>\n\n<script>\nimport bindEvents from '../base/bindEvent.js'\nimport {checkType} from '../base/util.js'\n\nexport default {\n  name: 'bm-map',\n  props: {\n    ak: {\n      type: String\n    },\n    center: {\n      type: [Object, String]\n    },\n    zoom: {\n      type: Number\n    },\n    minZoom: {\n      type: Number\n    },\n    maxZoom: {\n      type: Number\n    },\n    highResolution: {\n      type: Boolean,\n      default: true\n    },\n    mapClick: {\n      type: Boolean,\n      default: true\n    },\n    mapType: {\n      type: String\n    },\n    dragging: {\n      type: Boolean,\n      default: true\n    },\n    scrollWheelZoom: {\n      type: Boolean,\n      default: false\n    },\n    doubleClickZoom: {\n      type: Boolean,\n      default: true\n    },\n    keyboard: {\n      type: Boolean,\n      default: true\n    },\n    inertialDragging: {\n      type: Boolean,\n      default: true\n    },\n    continuousZoom: {\n      type: Boolean,\n      default: true\n    },\n    pinchToZoom: {\n      type: Boolean,\n      default: true\n    },\n    autoResize: {\n      type: Boolean,\n      default: true\n    },\n    theme: {\n      type: Array\n    },\n    mapStyle: {\n      type: Object\n    }\n  },\n  watch: {\n    center (val, oldVal) {\n      const {map, zoom} = this\n      if (checkType(val) === 'String' && val !== oldVal) {\n        map.centerAndZoom(val, zoom)\n      }\n    },\n    'center.lng' (val, oldVal) {\n      const {BMap, map, zoom, center} = this\n      if (val !== oldVal && val >= -180 && val <= 180) {\n        map.centerAndZoom(new BMap.Point(val, center.lat), zoom)\n      }\n    },\n    'center.lat' (val, oldVal) {\n      const {BMap, map, zoom, center} = this\n      if (val !== oldVal && val >= -74 && val <= 74) {\n        map.centerAndZoom(new BMap.Point(center.lng, val), zoom)\n      }\n    },\n    zoom (val, oldVal) {\n      const {map} = this\n      if (val !== oldVal && val >= 3 && val <= 19) {\n        map.setZoom(val)\n      }\n    },\n    minZoom (val) {\n      const {map} = this\n      map.setMinZoom(val)\n    },\n    maxZoom (val) {\n      const {map} = this\n      map.setMaxZoom(val)\n    },\n    highResolution () {\n      this.reset()\n    },\n    mapClick () {\n      this.reset()\n    },\n    mapType (val) {\n      const {map} = this\n      map.setMapType(global[val])\n    },\n    dragging (val) {\n      const {map} = this\n      val ? map.enableDragging() : map.disableDragging()\n    },\n    scrollWheelZoom (val) {\n      const {map} = this\n      val ? map.enableScrollWheelZoom() : map.disableScrollWheelZoom()\n    },\n    doubleClickZoom (val) {\n      const {map} = this\n      val ? map.enableDoubleClickZoom() : map.disableDoubleClickZoom()\n    },\n    keyboard (val) {\n      const {map} = this\n      val ? map.enableKeyboard() : map.disableKeyboard()\n    },\n    inertialDragging (val) {\n      const {map} = this\n      val ? map.enableInertialDragging() : map.disableInertialDragging()\n    },\n    continuousZoom (val) {\n      const {map} = this\n      val ? map.enableContinuousZoom() : map.disableContinuousZoom()\n    },\n    pinchToZoom (val) {\n      const {map} = this\n      val ? map.enablePinchToZoom() : map.disablePinchToZoom()\n    },\n    autoResize (val) {\n      const {map} = this\n      val ? map.enableAutoResize() : map.disableAutoResize()\n    },\n    theme (val) {\n      const {map} = this\n      map.setMapStyle({styleJson: val})\n    },\n    'mapStyle.features': {\n      handler (val, oldVal) {\n        const {map, mapStyle} = this\n        const {style, styleJson} = mapStyle\n        map.setMapStyle({\n          styleJson,\n          features: val,\n          style\n        })\n      },\n      deep: true\n    },\n    'mapStyle.style' (val, oldVal) {\n      const {map, mapStyle} = this\n      const {features, styleJson} = mapStyle\n      map.setMapStyle({\n        styleJson,\n        features,\n        style: val\n      })\n    },\n    'mapStyle.styleJson': {\n      handler (val, oldVal) {\n        const {map, mapStyle} = this\n        const {features, style} = mapStyle\n        map.setMapStyle({\n          styleJson: val,\n          features,\n          style\n        })\n      },\n      deep: true\n    },\n    mapStyle (val) {\n      const {map, theme} = this\n      !theme && map.setMapStyle(val)\n    }\n  },\n  methods: {\n    setMapOptions () {\n      const {map, minZoom, maxZoom, mapType, dragging, scrollWheelZoom, doubleClickZoom, keyboard, inertialDragging, continuousZoom, pinchToZoom, autoResize} = this\n      minZoom && map.setMinZoom(minZoom)\n      maxZoom && map.setMaxZoom(maxZoom)\n      mapType && map.setMapType(global[mapType])\n      dragging ? map.enableDragging() : map.disableDragging()\n      scrollWheelZoom ? map.enableScrollWheelZoom() : map.disableScrollWheelZoom()\n      doubleClickZoom ? map.enableDoubleClickZoom() : map.disableDoubleClickZoom()\n      keyboard ? map.enableKeyboard() : map.disableKeyboard()\n      inertialDragging ? map.enableInertialDragging() : map.disableInertialDragging()\n      continuousZoom ? map.enableContinuousZoom() : map.disableContinuousZoom()\n      pinchToZoom ? map.enablePinchToZoom() : map.disablePinchToZoom()\n      autoResize ? map.enableAutoResize() : map.disableAutoResize()\n    },\n    init (BMap) {\n      if (this.map) {\n        return\n      }\n      let $el = this.$refs.view\n      for (let $node of this.$slots.default || []) {\n        if ($node.componentOptions && $node.componentOptions.tag === 'bm-view') {\n          this.hasBmView = true\n          $el = $node.elm\n        }\n      }\n      const map = new BMap.Map($el, {enableHighResolution: this.highResolution, enableMapClick: this.mapClick})\n      this.map = map\n      const {setMapOptions, zoom, getCenterPoint, theme, mapStyle} = this\n      theme ? map.setMapStyle({styleJson: theme}) : map.setMapStyle(mapStyle)\n      setMapOptions()\n      bindEvents.call(this, map)\n      // 此处强行初始化一次地图 回避一个由于错误的 center 字符串导致初始化失败抛出的错误\n      map.reset()\n      map.centerAndZoom(getCenterPoint(), zoom)\n      this.$emit('ready', {BMap, map})\n      // Debug\n      // global.map = map\n      // global.mapComponent = this\n    },\n    getCenterPoint () {\n      const {center, BMap} = this\n      switch (checkType(center)) {\n        case 'String': return center\n        case 'Object': return new BMap.Point(center.lng, center.lat)\n        default: return new BMap.Point()\n      }\n    },\n    initMap (BMap) {\n      this.BMap = BMap\n      this.init(BMap)\n    },\n    getMapScript () {\n      if (!global.BMap) {\n        const ak = this.ak || this._BMap().ak\n        global.BMap = {}\n        global.BMap._preloader = new Promise((resolve, reject) => {\n          global._initBaiduMap = function () {\n            resolve(global.BMap)\n            global.document.body.removeChild($script)\n            global.BMap._preloader = null\n            global._initBaiduMap = null\n          }\n          const $script = document.createElement('script')\n          global.document.body.appendChild($script)\n          $script.src = `https://api.map.baidu.com/api?v=2.0&ak=${ak}&callback=_initBaiduMap`\n        })\n        return global.BMap._preloader\n      } else if (!global.BMap._preloader) {\n        return Promise.resolve(global.BMap)\n      } else {\n        return global.BMap._preloader\n      }\n    },\n    reset () {\n      const {getMapScript, initMap} = this\n      getMapScript()\n        .then(initMap)\n    }\n  },\n  mounted () {\n    this.reset()\n  },\n  data () {\n    return {\n      hasBmView: false\n    }\n  }\n}\n</script>\n"]},"metadata":{},"sourceType":"module"}